

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>h2o.connection &mdash; H2O  documentation</title>
  

  
  

  
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,300,700|Inconsolata:400,700' rel='stylesheet' type='text/css'>

  
  
    

  

  
  
    <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  

  
    <link rel="top" title="H2O  documentation" href="../../index.html"/>
        <link rel="up" title="Module code" href="../index.html"/> 

  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/modernizr/2.6.2/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-nav-search">
        <a href="../../index.html" class="fa fa-home"> H2O</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
        
        
            <ul>
<li class="toctree-l1"><a class="reference internal" href="../../intro.html">The H2O Python Module</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../intro.html#what-is-h2o">What is H2O?</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../intro.html#h2o-cluster-inspection">H2O Cluster Inspection</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../intro.html#objects-in-this-module">Objects In This Module</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../intro.html#example-of-h2o-on-hadoop">Example of H2O on Hadoop</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../h2o.html">H2O Module</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../h2o.html#module-h2o.h2o"><code class="docutils literal"><span class="pre">h2o</span></code></a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../data.html">Data In H2O</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../data.html#loading-data-from-a-csv-file">Loading Data From A CSV File</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../data.html#loading-data-from-a-python-object">Loading Data From A Python Object</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../frame.html">Data Manipulation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../frame.html#h2oframe"><code class="docutils literal"><span class="pre">H2OFrame</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../../frame.html#groupby"><code class="docutils literal"><span class="pre">GroupBy</span></code></a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../modeling.html">Modeling In H2O</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../modeling.html#h2oestimator"><code class="docutils literal"><span class="pre">H2OEstimator</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../../modeling.html#h2odeeplearningestimator"><code class="docutils literal"><span class="pre">H2ODeepLearningEstimator</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../../modeling.html#h2oautoencoderestimator"><code class="docutils literal"><span class="pre">H2OAutoEncoderEstimator</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../../modeling.html#h2orandomforestestimator"><code class="docutils literal"><span class="pre">H2ORandomForestEstimator</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../../modeling.html#h2ogradientboostingestimator"><code class="docutils literal"><span class="pre">H2OGradientBoostingEstimator</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../../modeling.html#h2ogeneralizedlinearestimator"><code class="docutils literal"><span class="pre">H2OGeneralizedLinearEstimator</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../../modeling.html#h2ogeneralizedlowrankestimator"><code class="docutils literal"><span class="pre">H2OGeneralizedLowRankEstimator</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../../modeling.html#h2okmeansestimator"><code class="docutils literal"><span class="pre">H2OKMeansEstimator</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../../modeling.html#h2onaivebayesestimator"><code class="docutils literal"><span class="pre">H2ONaiveBayesEstimator</span></code></a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../model_categories.html">Model Categories</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../model_categories.html#module-h2o.model.model_base"><code class="docutils literal"><span class="pre">ModelBase</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../../model_categories.html#module-h2o.model.binomial"><code class="docutils literal"><span class="pre">Binomial</span> <span class="pre">Classification</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../../model_categories.html#module-h2o.model.multinomial"><code class="docutils literal"><span class="pre">Multinomial</span> <span class="pre">Classification</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../../model_categories.html#module-h2o.model.regression"><code class="docutils literal"><span class="pre">Regression</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../../model_categories.html#module-h2o.model.clustering"><code class="docutils literal"><span class="pre">Clustering</span> <span class="pre">Methods</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../../model_categories.html#module-h2o.model.autoencoder"><code class="docutils literal"><span class="pre">AutoEncoders</span></code></a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../metrics.html">Metrics in H2O</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../assembly.html">H2OAssembly</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../other.html">REST Interface</a></li>
</ul>

        
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../../index.html">H2O</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../../index.html">Docs</a> &raquo;</li>
      
          <li><a href="../index.html">Module code</a> &raquo;</li>
      
    <li>h2o.connection</li>
      <li class="wy-breadcrumbs-aside">
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main">
            
  <h1>Source code for h2o.connection</h1><div class="highlight"><pre>
<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">An H2OConnection represents the latest active handle to a cloud. No more than a single</span>
<span class="sd">H2OConnection object will be active at any one time.</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="n">print_function</span>
<span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="n">absolute_import</span>
<span class="kn">import</span> <span class="nn">requests</span>
<span class="kn">import</span> <span class="nn">math</span>
<span class="kn">import</span> <span class="nn">tempfile</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">re</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">time</span>
<span class="kn">import</span> <span class="nn">subprocess</span>
<span class="kn">import</span> <span class="nn">atexit</span>
<span class="kn">import</span> <span class="nn">warnings</span>
<span class="kn">import</span> <span class="nn">site</span>
<span class="kn">from</span> <span class="nn">.display</span> <span class="kn">import</span> <span class="n">H2ODisplay</span>
<span class="kn">from</span> <span class="nn">.h2o_logging</span> <span class="kn">import</span> <span class="n">_is_logging</span><span class="p">,</span> <span class="n">_log_rest</span>
<span class="kn">from</span> <span class="nn">.two_dim_table</span> <span class="kn">import</span> <span class="n">H2OTwoDimTable</span>
<span class="kn">from</span> <span class="nn">.utils.shared_utils</span> <span class="kn">import</span> <span class="n">quote</span>
<span class="kn">from</span> <span class="nn">six</span> <span class="kn">import</span> <span class="n">iteritems</span><span class="p">,</span> <span class="n">PY3</span>
<span class="kn">from</span> <span class="nn">string</span> <span class="kn">import</span> <span class="n">ascii_lowercase</span><span class="p">,</span> <span class="n">digits</span>
<span class="kn">from</span> <span class="nn">random</span> <span class="kn">import</span> <span class="n">choice</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">simplefilter</span><span class="p">(</span><span class="s">&#39;always&#39;</span><span class="p">,</span> <span class="ne">UserWarning</span><span class="p">)</span>
<span class="k">try</span><span class="p">:</span>
  <span class="n">warnings</span><span class="o">.</span><span class="n">simplefilter</span><span class="p">(</span><span class="s">&#39;ignore&#39;</span><span class="p">,</span> <span class="n">requests</span><span class="o">.</span><span class="n">packages</span><span class="o">.</span><span class="n">urllib3</span><span class="o">.</span><span class="n">exceptions</span><span class="o">.</span><span class="n">InsecureRequestWarning</span><span class="p">)</span>
<span class="k">except</span><span class="p">:</span>
  <span class="k">pass</span>
<span class="n">__H2OCONN__</span> <span class="o">=</span> <span class="bp">None</span>            <span class="c"># the single active connection to H2O cloud</span>
<span class="n">__H2O_REST_API_VERSION__</span> <span class="o">=</span> <span class="mi">3</span>  <span class="c"># const for the version of the rest api</span>


<div class="viewcode-block" id="H2OConnection"><a class="viewcode-back" href="../../other.html#h2o.connection.H2OConnection">[docs]</a><span class="k">class</span> <span class="nc">H2OConnection</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
  <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">  H2OConnection is a class that represents a connection to the H2O cluster.</span>
<span class="sd">  It is specified by an IP address and a port number.</span>

<span class="sd">  Objects of type H2OConnection are not instantiated directly!</span>

<span class="sd">  This class contains static methods for performing the common REST methods</span>
<span class="sd">  GET, POST, and DELETE.</span>
<span class="sd">  &quot;&quot;&quot;</span>

  <span class="n">__ENCODING__</span> <span class="o">=</span> <span class="s">&quot;utf-8&quot;</span>
  <span class="n">__ENCODING_ERROR__</span> <span class="o">=</span> <span class="s">&quot;replace&quot;</span>

  <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ip</span><span class="p">,</span> <span class="n">port</span><span class="p">,</span> <span class="n">start_h2o</span><span class="p">,</span> <span class="n">enable_assertions</span><span class="p">,</span> <span class="n">license</span><span class="p">,</span> <span class="n">nthreads</span><span class="p">,</span> <span class="n">max_mem_size</span><span class="p">,</span> <span class="n">min_mem_size</span><span class="p">,</span> <span class="n">ice_root</span><span class="p">,</span>
               <span class="n">strict_version_check</span><span class="p">,</span> <span class="n">proxy</span><span class="p">,</span> <span class="n">https</span><span class="p">,</span> <span class="n">insecure</span><span class="p">,</span> <span class="n">username</span><span class="p">,</span> <span class="n">password</span><span class="p">,</span> <span class="n">max_mem_size_GB</span><span class="p">,</span> <span class="n">min_mem_size_GB</span><span class="p">,</span> <span class="n">proxies</span><span class="p">,</span> <span class="n">size</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Instantiate the package handle to the H2O cluster.</span>
<span class="sd">    :param ip: An IP address, default is &quot;localhost&quot;</span>
<span class="sd">    :param port: A port, default is 54321</span>
<span class="sd">    :param start_h2o: A boolean dictating whether this module should start the H2O jvm. An attempt is made anyways if _connect fails.</span>
<span class="sd">    :param enable_assertions: If start_h2o, pass `-ea` as a VM option.</span>
<span class="sd">    :param license: If not None, is a path to a license file.</span>
<span class="sd">    :param nthreads: Number of threads in the thread pool. This relates very closely to the number of CPUs used. </span>
<span class="sd">    -1 means use all CPUs on the host. A positive integer specifies the number of CPUs directly. This value is only used when Python starts H2O.</span>
<span class="sd">    :param max_mem_size: Maximum heap size (jvm option Xmx) in gigabytes.</span>
<span class="sd">    :param min_mem_size: Minimum heap size (jvm option Xms) in gigabytes.</span>
<span class="sd">    :param ice_root: A temporary directory (default location is determined by tempfile.mkdtemp()) to hold H2O log files.</span>
<span class="sd">    :param strict_version_check: Setting this to False is unsupported and should only be done when advised by technical support.</span>
<span class="sd">    :param proxy: A dictionary with keys &#39;ftp&#39;, &#39;http&#39;, &#39;https&#39; and values that correspond to a proxy path.</span>
<span class="sd">    :param https: Set this to True to use https instead of http.</span>
<span class="sd">    :param insecure: Set this to True to disable SSL certificate checking.</span>
<span class="sd">    :param username: Username to login with.</span>
<span class="sd">    :param password: Password to login with. </span>
<span class="sd">    :param max_mem_size_GB: DEPRECATED. Use max_mem_size.</span>
<span class="sd">    :param min_mem_size_GB: DEPRECATED. Use min_mem_size.</span>
<span class="sd">    :param proxies: DEPRECATED. Use proxy.</span>
<span class="sd">    :param size: DEPRECATED.</span>
<span class="sd">    :return: None</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">port</span> <span class="o">=</span> <span class="n">as_int</span><span class="p">(</span><span class="n">port</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">port</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span> <span class="ow">and</span> <span class="mi">0</span> <span class="o">&lt;=</span> <span class="n">port</span> <span class="o">&lt;=</span> <span class="n">sys</span><span class="o">.</span><span class="n">maxsize</span><span class="p">):</span> <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&quot;Port out of range, &quot;</span><span class="o">+</span><span class="n">port</span><span class="p">)</span>
    
    <span class="k">if</span> <span class="n">https</span> <span class="o">!=</span> <span class="n">insecure</span><span class="p">:</span> <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&quot;`https` and `insecure` must both be True to enable HTTPS&quot;</span><span class="p">)</span>
    
    <span class="c">#Deprecated params</span>
    <span class="k">if</span> <span class="n">max_mem_size_GB</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
      <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s">&quot;`max_mem_size_GB` is deprecated. Use `max_mem_size` instead.&quot;</span><span class="p">,</span> <span class="n">category</span><span class="o">=</span><span class="ne">DeprecationWarning</span><span class="p">)</span>
      <span class="n">max_mem_size</span> <span class="o">=</span> <span class="n">max_mem_size_GB</span>
    <span class="k">if</span> <span class="n">min_mem_size_GB</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
      <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s">&quot;`min_mem_size_GB` is deprecated. Use `min_mem_size` instead.&quot;</span><span class="p">,</span> <span class="n">category</span><span class="o">=</span><span class="ne">DeprecationWarning</span><span class="p">)</span>
      <span class="n">min_mem_size</span> <span class="o">=</span> <span class="n">min_mem_size_GB</span>
    <span class="k">if</span> <span class="n">proxies</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
      <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s">&quot;`proxies` is deprecated. Use `proxy` instead.&quot;</span><span class="p">,</span> <span class="n">category</span><span class="o">=</span><span class="ne">DeprecationWarning</span><span class="p">)</span>
      <span class="n">proxy</span> <span class="o">=</span> <span class="n">proxies</span>
    <span class="k">if</span> <span class="n">size</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
      <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s">&quot;`size` is deprecated.&quot;</span><span class="p">,</span> <span class="n">category</span><span class="o">=</span><span class="ne">DeprecationWarning</span><span class="p">)</span>
    
    <span class="k">global</span> <span class="n">__H2OCONN__</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_cld</span> <span class="o">=</span> <span class="bp">None</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_ip</span> <span class="o">=</span> <span class="n">ip</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_port</span> <span class="o">=</span> <span class="n">port</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_proxy</span> <span class="o">=</span> <span class="n">proxy</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_https</span> <span class="o">=</span> <span class="n">https</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_insecure</span> <span class="o">=</span> <span class="n">insecure</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_username</span> <span class="o">=</span> <span class="n">username</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_password</span> <span class="o">=</span> <span class="n">password</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_session_id</span> <span class="o">=</span> <span class="bp">None</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_rest_version</span> <span class="o">=</span> <span class="n">__H2O_REST_API_VERSION__</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_child</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">__H2OCONN__</span><span class="p">,</span> <span class="s">&quot;_child&quot;</span><span class="p">)</span> <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">__H2OCONN__</span><span class="p">,</span> <span class="s">&quot;_child&quot;</span><span class="p">)</span> <span class="k">else</span> <span class="bp">None</span>
    <span class="n">__H2OCONN__</span> <span class="o">=</span> <span class="bp">self</span>

    <span class="c">#Give user warning if proxy environment variable is found. PUBDEV-2504</span>
    <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
      <span class="k">if</span> <span class="n">name</span><span class="o">.</span><span class="n">lower</span><span class="p">()[</span><span class="o">-</span><span class="mi">6</span><span class="p">:]</span> <span class="o">==</span> <span class="s">&#39;_proxy&#39;</span> <span class="ow">and</span> <span class="n">value</span><span class="p">:</span>
        <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s">&quot;Proxy environment variable `&quot;</span> <span class="o">+</span> <span class="n">name</span> <span class="o">+</span> <span class="s">&quot;` with value `&quot;</span> <span class="o">+</span> <span class="n">value</span> <span class="o">+</span> <span class="s">&quot;` found. This may interfere with your H2O Connection.&quot;</span><span class="p">)</span>

    <span class="n">jarpaths</span> <span class="o">=</span> <span class="n">H2OConnection</span><span class="o">.</span><span class="n">jar_paths</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">jarpaths</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>   <span class="n">jar_path</span> <span class="o">=</span> <span class="n">jarpaths</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">elif</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">jarpaths</span><span class="p">[</span><span class="mi">1</span><span class="p">]):</span> <span class="n">jar_path</span> <span class="o">=</span> <span class="n">jarpaths</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="k">elif</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">jarpaths</span><span class="p">[</span><span class="mi">2</span><span class="p">]):</span> <span class="n">jar_path</span> <span class="o">=</span> <span class="n">jarpaths</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
    <span class="k">elif</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">jarpaths</span><span class="p">[</span><span class="mi">3</span><span class="p">]):</span> <span class="n">jar_path</span> <span class="o">=</span> <span class="n">jarpaths</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
    <span class="k">elif</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">jarpaths</span><span class="p">[</span><span class="mi">4</span><span class="p">]):</span> <span class="n">jar_path</span> <span class="o">=</span> <span class="n">jarpaths</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>                             <span class="n">jar_path</span> <span class="o">=</span> <span class="n">jarpaths</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span>
    <span class="k">try</span><span class="p">:</span>
      <span class="n">cld</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_connect</span><span class="p">()</span>
    <span class="k">except</span><span class="p">:</span>
      <span class="c"># try to start local jar or re-raise previous exception</span>
      <span class="k">if</span> <span class="ow">not</span> <span class="n">start_h2o</span><span class="p">:</span> <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&quot;Cannot connect to H2O server. Please check that H2O is running at {}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">H2OConnection</span><span class="o">.</span><span class="n">make_url</span><span class="p">(</span><span class="s">&quot;&quot;</span><span class="p">)))</span>
      <span class="k">print</span><span class="p">()</span>
      <span class="k">print</span><span class="p">()</span>
      <span class="k">print</span><span class="p">(</span><span class="s">&quot;No instance found at ip and port: &quot;</span> <span class="o">+</span> <span class="n">ip</span> <span class="o">+</span> <span class="s">&quot;:&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">port</span><span class="p">)</span> <span class="o">+</span> <span class="s">&quot;. Trying to start local jar...&quot;</span><span class="p">)</span>
      <span class="k">print</span><span class="p">()</span>
      <span class="k">print</span><span class="p">()</span>
      <span class="n">path_to_jar</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">jar_path</span><span class="p">)</span>
      <span class="k">if</span> <span class="n">path_to_jar</span><span class="p">:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">ice_root</span><span class="p">:</span>
          <span class="n">ice_root</span> <span class="o">=</span> <span class="n">tempfile</span><span class="o">.</span><span class="n">mkdtemp</span><span class="p">()</span>
        <span class="n">cld</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_start_local_h2o_jar</span><span class="p">(</span><span class="n">max_mem_size</span><span class="p">,</span> <span class="n">min_mem_size</span><span class="p">,</span> <span class="n">enable_assertions</span><span class="p">,</span> <span class="n">license</span><span class="p">,</span> <span class="n">ice_root</span><span class="p">,</span> <span class="n">jar_path</span><span class="p">,</span> <span class="n">nthreads</span><span class="p">)</span>
      <span class="k">else</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="s">&quot;No jar file found. Could not start local instance.&quot;</span><span class="p">)</span>
        <span class="k">print</span><span class="p">(</span><span class="s">&quot;Jar Paths searched: &quot;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">jp</span> <span class="ow">in</span> <span class="n">jarpaths</span><span class="p">:</span>
          <span class="k">print</span><span class="p">(</span><span class="s">&quot;</span><span class="se">\t</span><span class="s">&quot;</span> <span class="o">+</span> <span class="n">jp</span><span class="p">)</span>
        <span class="k">print</span><span class="p">()</span>
        <span class="k">raise</span>
    <span class="n">__H2OCONN__</span><span class="o">.</span><span class="n">_cld</span> <span class="o">=</span> <span class="n">cld</span>

    <span class="k">if</span> <span class="n">strict_version_check</span> <span class="ow">and</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">&#39;H2O_DISABLE_STRICT_VERSION_CHECK&#39;</span><span class="p">)</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
      <span class="n">ver_h2o</span> <span class="o">=</span> <span class="n">cld</span><span class="p">[</span><span class="s">&#39;version&#39;</span><span class="p">]</span>
      <span class="kn">from</span> <span class="nn">.__init__</span> <span class="kn">import</span> <span class="n">__version__</span>
      <span class="n">ver_pkg</span> <span class="o">=</span> <span class="s">&quot;UNKNOWN&quot;</span> <span class="k">if</span> <span class="n">__version__</span> <span class="o">==</span> <span class="s">&quot;SUBST_PROJECT_VERSION&quot;</span> <span class="k">else</span> <span class="n">__version__</span>
      <span class="k">if</span> <span class="n">ver_h2o</span> <span class="o">!=</span> <span class="n">ver_pkg</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
          <span class="n">branch_name_h2o</span> <span class="o">=</span> <span class="n">cld</span><span class="p">[</span><span class="s">&#39;branch_name&#39;</span><span class="p">]</span>
        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
          <span class="n">branch_name_h2o</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="k">else</span><span class="p">:</span>
          <span class="n">branch_name_h2o</span> <span class="o">=</span> <span class="n">cld</span><span class="p">[</span><span class="s">&#39;branch_name&#39;</span><span class="p">]</span>

        <span class="k">try</span><span class="p">:</span>
          <span class="n">build_number_h2o</span> <span class="o">=</span> <span class="n">cld</span><span class="p">[</span><span class="s">&#39;build_number&#39;</span><span class="p">]</span>
        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
          <span class="n">build_number_h2o</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="k">else</span><span class="p">:</span>
          <span class="n">build_number_h2o</span> <span class="o">=</span> <span class="n">cld</span><span class="p">[</span><span class="s">&#39;build_number&#39;</span><span class="p">]</span>

        <span class="k">if</span> <span class="n">build_number_h2o</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
          <span class="k">print</span><span class="p">(</span><span class="s">&quot;Version mismatch. H2O is version {0}, but the h2o-python package is version {1}. Upgrade H2O and h2o-Python to latest stable version - http://h2o-release.s3.amazonaws.com/h2o/latest_stable.html&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">ver_h2o</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">ver_pkg</span><span class="p">)))</span>
          <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="s">&quot;STOP: FIX VERSION MISMATCH TO AVOID FUTURE ERRORS&quot;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">build_number_h2o</span> <span class="o">==</span> <span class="s">&#39;unknown&#39;</span><span class="p">:</span>
          <span class="k">print</span><span class="p">(</span><span class="s">&quot;Version mismatch. H2O is version {0}, but the h2o-python package is version {1}. Upgrade H2O and h2o-Python to latest stable version - http://h2o-release.s3.amazonaws.com/h2o/latest_stable.html&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">ver_h2o</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">ver_pkg</span><span class="p">)))</span>
          <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="s">&quot;STOP: FIX VERSION MISMATCH TO AVOID FUTURE ERRORS&quot;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">build_number_h2o</span> <span class="o">==</span> <span class="s">&#39;99999&#39;</span><span class="p">:</span>
          <span class="k">print</span><span class="p">(</span><span class="s">&quot;Version mismatch. H2O is version {0}, but the h2o-python package is version {1}. This is a developer build, please contact your developer.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">ver_h2o</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">ver_pkg</span><span class="p">)))</span>
          <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="s">&quot;STOP: FIX VERSION MISMATCH TO AVOID FUTURE ERRORS&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
          <span class="k">print</span><span class="p">(</span><span class="s">&quot;Version mismatch. H2O is version {0}, but the h2o-python package is version {1}.Install the matching h2o-Python version from - http://h2o-release.s3.amazonaws.com/h2o/{2}/{3}/index.html.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">ver_h2o</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">ver_pkg</span><span class="p">),</span><span class="n">branch_name_h2o</span><span class="p">,</span> <span class="n">build_number_h2o</span><span class="p">))</span>
          <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="s">&quot;STOP: FIX VERSION MISMATCH TO AVOID FUTURE ERRORS&quot;</span><span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">_session_id</span> <span class="o">=</span> <span class="n">H2OConnection</span><span class="o">.</span><span class="n">get_json</span><span class="p">(</span><span class="n">url_suffix</span><span class="o">=</span><span class="s">&quot;InitID&quot;</span><span class="p">)[</span><span class="s">&quot;session_key&quot;</span><span class="p">]</span>
    <span class="n">H2OConnection</span><span class="o">.</span><span class="n">_cluster_info</span><span class="p">()</span>

  <span class="nd">@staticmethod</span>
<div class="viewcode-block" id="H2OConnection.default"><a class="viewcode-back" href="../../other.html#h2o.connection.H2OConnection.default">[docs]</a>  <span class="k">def</span> <span class="nf">default</span><span class="p">():</span>
    <span class="n">H2OConnection</span><span class="o">.</span><span class="n">__ENCODING__</span> <span class="o">=</span> <span class="s">&quot;utf-8&quot;</span>
    <span class="n">H2OConnection</span><span class="o">.</span><span class="n">__ENCODING_ERROR__</span> <span class="o">=</span> <span class="s">&quot;replace&quot;</span></div>

  <span class="nd">@staticmethod</span>
<div class="viewcode-block" id="H2OConnection.jar_paths"><a class="viewcode-back" href="../../other.html#h2o.connection.H2OConnection.jar_paths">[docs]</a>  <span class="k">def</span> <span class="nf">jar_paths</span><span class="p">():</span>
    <span class="n">sys_prefix1</span> <span class="o">=</span> <span class="n">sys_prefix2</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">prefix</span>
    <span class="k">if</span> <span class="n">sys_prefix1</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s">&#39;/Library&#39;</span><span class="p">):</span> <span class="n">sys_prefix2</span> <span class="o">=</span> <span class="s">&#39;/System&#39;</span><span class="o">+</span><span class="n">sys_prefix1</span>
    <span class="k">elif</span> <span class="n">sys_prefix1</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s">&#39;/System&#39;</span><span class="p">):</span> <span class="n">sys_prefix2</span> <span class="o">=</span> <span class="n">sys_prefix1</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s">&#39;/System&#39;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>
    <span class="k">return</span> <span class="p">[</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">sys_prefix1</span><span class="p">,</span> <span class="s">&quot;h2o_jar&quot;</span><span class="p">,</span> <span class="s">&quot;h2o.jar&quot;</span><span class="p">),</span>
            <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">sep</span><span class="p">,</span><span class="s">&quot;usr&quot;</span><span class="p">,</span><span class="s">&quot;local&quot;</span><span class="p">,</span><span class="s">&quot;h2o_jar&quot;</span><span class="p">,</span><span class="s">&quot;h2o.jar&quot;</span><span class="p">),</span>
            <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">sys_prefix1</span><span class="p">,</span> <span class="s">&quot;local&quot;</span><span class="p">,</span> <span class="s">&quot;h2o_jar&quot;</span><span class="p">,</span> <span class="s">&quot;h2o.jar&quot;</span><span class="p">),</span>
            <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">site</span><span class="o">.</span><span class="n">USER_BASE</span><span class="p">,</span> <span class="s">&quot;h2o_jar&quot;</span><span class="p">,</span> <span class="s">&quot;h2o.jar&quot;</span><span class="p">),</span>
            <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">sys_prefix2</span><span class="p">,</span> <span class="s">&quot;h2o_jar&quot;</span><span class="p">,</span> <span class="s">&quot;h2o.jar&quot;</span><span class="p">),</span>
            <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">sys_prefix2</span><span class="p">,</span> <span class="s">&quot;h2o_jar&quot;</span><span class="p">,</span> <span class="s">&quot;h2o.jar&quot;</span><span class="p">),</span>
           <span class="p">]</span></div>

  <span class="nd">@staticmethod</span>
  <span class="k">def</span> <span class="nf">_cluster_info</span><span class="p">():</span>
    <span class="k">global</span> <span class="n">__H2OCONN__</span>
    <span class="n">cld</span> <span class="o">=</span> <span class="n">__H2OCONN__</span><span class="o">.</span><span class="n">_cld</span>
    <span class="n">ncpus</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">([</span><span class="n">n</span><span class="p">[</span><span class="s">&#39;num_cpus&#39;</span><span class="p">]</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">cld</span><span class="p">[</span><span class="s">&#39;nodes&#39;</span><span class="p">]])</span>
    <span class="n">allowed_cpus</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">([</span><span class="n">n</span><span class="p">[</span><span class="s">&#39;cpus_allowed&#39;</span><span class="p">]</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">cld</span><span class="p">[</span><span class="s">&#39;nodes&#39;</span><span class="p">]])</span>
    <span class="n">mfree</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">([</span><span class="n">n</span><span class="p">[</span><span class="s">&#39;free_mem&#39;</span><span class="p">]</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">cld</span><span class="p">[</span><span class="s">&#39;nodes&#39;</span><span class="p">]])</span>
    <span class="n">cluster_health</span> <span class="o">=</span> <span class="nb">all</span><span class="p">([</span><span class="n">n</span><span class="p">[</span><span class="s">&#39;healthy&#39;</span><span class="p">]</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">cld</span><span class="p">[</span><span class="s">&#39;nodes&#39;</span><span class="p">]])</span>
    <span class="n">ip</span> <span class="o">=</span> <span class="s">&quot;127.0.0.1&quot;</span> <span class="k">if</span> <span class="n">__H2OCONN__</span><span class="o">.</span><span class="n">_ip</span><span class="o">==</span><span class="s">&quot;localhost&quot;</span> <span class="k">else</span> <span class="n">__H2OCONN__</span><span class="o">.</span><span class="n">_ip</span>
    <span class="n">cluster_info</span> <span class="o">=</span> <span class="p">[</span>
      <span class="p">[</span><span class="s">&quot;H2O cluster uptime: &quot;</span><span class="p">,</span> <span class="n">get_human_readable_time</span><span class="p">(</span><span class="n">cld</span><span class="p">[</span><span class="s">&quot;cloud_uptime_millis&quot;</span><span class="p">])],</span>
      <span class="p">[</span><span class="s">&quot;H2O cluster version: &quot;</span><span class="p">,</span> <span class="n">cld</span><span class="p">[</span><span class="s">&quot;version&quot;</span><span class="p">]],</span>
      <span class="p">[</span><span class="s">&quot;H2O cluster name: &quot;</span><span class="p">,</span> <span class="n">cld</span><span class="p">[</span><span class="s">&quot;cloud_name&quot;</span><span class="p">]],</span>
      <span class="p">[</span><span class="s">&quot;H2O cluster total nodes: &quot;</span><span class="p">,</span> <span class="n">cld</span><span class="p">[</span><span class="s">&quot;cloud_size&quot;</span><span class="p">]],</span>
      <span class="p">[</span><span class="s">&quot;H2O cluster total free memory: &quot;</span><span class="p">,</span> <span class="n">get_human_readable_size</span><span class="p">(</span><span class="n">mfree</span><span class="p">)],</span>
      <span class="p">[</span><span class="s">&quot;H2O cluster total cores: &quot;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">ncpus</span><span class="p">)],</span>
      <span class="p">[</span><span class="s">&quot;H2O cluster allowed cores: &quot;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">allowed_cpus</span><span class="p">)],</span>
      <span class="p">[</span><span class="s">&quot;H2O cluster healthy: &quot;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">cluster_health</span><span class="p">)],</span>
      <span class="p">[</span><span class="s">&quot;H2O Connection ip: &quot;</span><span class="p">,</span> <span class="n">ip</span><span class="p">],</span>
      <span class="p">[</span><span class="s">&quot;H2O Connection port: &quot;</span><span class="p">,</span> <span class="n">__H2OCONN__</span><span class="o">.</span><span class="n">_port</span><span class="p">],</span>
      <span class="p">[</span><span class="s">&quot;H2O Connection proxy: &quot;</span><span class="p">,</span> <span class="n">__H2OCONN__</span><span class="o">.</span><span class="n">_proxy</span><span class="p">],</span>
      <span class="p">[</span><span class="s">&quot;Python Version: &quot;</span><span class="p">,</span> <span class="n">sys</span><span class="o">.</span><span class="n">version</span><span class="o">.</span><span class="n">split</span><span class="p">()[</span><span class="mi">0</span><span class="p">]],</span>
      <span class="p">]</span>
    <span class="n">__H2OCONN__</span><span class="o">.</span><span class="n">_cld</span> <span class="o">=</span> <span class="n">H2OConnection</span><span class="o">.</span><span class="n">get_json</span><span class="p">(</span><span class="n">url_suffix</span><span class="o">=</span><span class="s">&quot;Cloud&quot;</span><span class="p">)</span>   <span class="c"># update the cached version of cld</span>
    <span class="n">H2ODisplay</span><span class="p">(</span><span class="n">cluster_info</span><span class="p">)</span>

  <span class="k">def</span> <span class="nf">_connect</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">max_retries</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">print_dots</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Does not actually &quot;connect&quot;, instead simply tests that the cluster can be reached,</span>
<span class="sd">    is of a certain size, and is taking basic status commands.</span>
<span class="sd">    </span>
<span class="sd">    :param size: The number of H2O instances in the cloud.</span>
<span class="sd">    :return: The JSON response from a &quot;stable&quot; cluster.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">retries</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="k">while</span> <span class="bp">True</span><span class="p">:</span>
      <span class="n">retries</span> <span class="o">+=</span> <span class="mi">1</span>
      <span class="k">if</span> <span class="n">print_dots</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_print_dots</span><span class="p">(</span><span class="n">retries</span><span class="p">)</span>
      <span class="k">try</span><span class="p">:</span>
        <span class="n">cld</span> <span class="o">=</span> <span class="n">H2OConnection</span><span class="o">.</span><span class="n">get_json</span><span class="p">(</span><span class="n">url_suffix</span><span class="o">=</span><span class="s">&quot;Cloud&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">cld</span><span class="p">[</span><span class="s">&#39;cloud_healthy&#39;</span><span class="p">]:</span>
          <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&quot;Cluster reports unhealthy status&quot;</span><span class="p">,</span> <span class="n">cld</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">cld</span><span class="p">[</span><span class="s">&#39;cloud_size&#39;</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">size</span> <span class="ow">and</span> <span class="n">cld</span><span class="p">[</span><span class="s">&#39;consensus&#39;</span><span class="p">]:</span>
          <span class="k">if</span> <span class="n">print_dots</span><span class="p">:</span> <span class="k">print</span><span class="p">(</span><span class="s">&quot; Connection successful!&quot;</span><span class="p">)</span>
          <span class="k">return</span> <span class="n">cld</span>
      <span class="k">except</span> <span class="ne">EnvironmentError</span><span class="p">:</span>
        <span class="k">pass</span>
      <span class="c"># Cloud too small or voting in progress; sleep; try again</span>
      <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.1</span><span class="p">)</span>
      <span class="k">if</span> <span class="n">retries</span> <span class="o">&gt;</span> <span class="n">max_retries</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">EnvironmentError</span><span class="p">(</span><span class="s">&quot;Max retries exceeded. Could not establish link to the H2O cloud @ &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_ip</span><span class="p">)</span> <span class="o">+</span> <span class="s">&quot;:&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_port</span><span class="p">))</span>

  <span class="k">def</span> <span class="nf">_print_dots</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">retries</span><span class="p">):</span>
    <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">&quot;</span><span class="se">\r</span><span class="s">Starting H2O JVM and connecting: {}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s">&quot;.&quot;</span> <span class="o">*</span> <span class="n">retries</span><span class="p">))</span>
    <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span>

  <span class="k">def</span> <span class="nf">_start_local_h2o_jar</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mmax</span><span class="p">,</span> <span class="n">mmin</span><span class="p">,</span> <span class="n">ea</span><span class="p">,</span> <span class="n">license</span><span class="p">,</span> <span class="n">ice</span><span class="p">,</span> <span class="n">jar_path</span><span class="p">,</span> <span class="n">nthreads</span><span class="p">):</span>
    <span class="n">command</span> <span class="o">=</span> <span class="n">H2OConnection</span><span class="o">.</span><span class="n">_check_java</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">license</span><span class="p">:</span>
      <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">license</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&quot;License file not found (&quot;</span> <span class="o">+</span> <span class="n">license</span> <span class="o">+</span> <span class="s">&quot;)&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">ice</span><span class="p">:</span>
      <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&quot;`ice_root` must be specified&quot;</span><span class="p">)</span>

    <span class="n">stdout</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">H2OConnection</span><span class="o">.</span><span class="n">_tmp_file</span><span class="p">(</span><span class="s">&quot;stdout&quot;</span><span class="p">),</span> <span class="s">&#39;w&#39;</span><span class="p">)</span>
    <span class="n">stderr</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">H2OConnection</span><span class="o">.</span><span class="n">_tmp_file</span><span class="p">(</span><span class="s">&quot;stderr&quot;</span><span class="p">),</span> <span class="s">&#39;w&#39;</span><span class="p">)</span>

    <span class="k">print</span><span class="p">(</span><span class="s">&quot;Using ice_root: &quot;</span> <span class="o">+</span> <span class="n">ice</span><span class="p">)</span>
    <span class="k">print</span><span class="p">()</span>

    <span class="n">jver</span> <span class="o">=</span> <span class="n">subprocess</span><span class="o">.</span><span class="n">check_output</span><span class="p">([</span><span class="n">command</span><span class="p">,</span> <span class="s">&quot;-version&quot;</span><span class="p">],</span> <span class="n">stderr</span><span class="o">=</span><span class="n">subprocess</span><span class="o">.</span><span class="n">STDOUT</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">PY3</span><span class="p">:</span> <span class="n">jver</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">jver</span><span class="p">,</span> <span class="n">H2OConnection</span><span class="o">.</span><span class="n">__ENCODING__</span><span class="p">)</span>

    <span class="k">print</span><span class="p">()</span>
    <span class="k">print</span><span class="p">(</span><span class="s">&quot;Java Version: &quot;</span> <span class="o">+</span> <span class="n">jver</span><span class="p">)</span>
    <span class="k">print</span><span class="p">()</span>

    <span class="k">if</span> <span class="s">&quot;GNU libgcj&quot;</span> <span class="ow">in</span> <span class="n">jver</span><span class="p">:</span>
      <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&quot;Sorry, GNU Java is not supported for H2O.</span><span class="se">\n</span><span class="s">&quot;</span><span class="o">+</span>
                       <span class="s">&quot;Please download the latest Java SE JDK 7 from the following URL:</span><span class="se">\n</span><span class="s">&quot;</span><span class="o">+</span>
                       <span class="s">&quot;http://www.oracle.com/technetwork/java/javase/downloads/jdk7-downloads-1880260.html&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="s">&quot;Client VM&quot;</span> <span class="ow">in</span> <span class="n">jver</span><span class="p">:</span>
      <span class="k">print</span><span class="p">(</span><span class="s">&quot;WARNING: &quot;</span><span class="p">)</span>
      <span class="k">print</span><span class="p">(</span><span class="s">&quot;You have a 32-bit version of Java. H2O works best with 64-bit Java.&quot;</span><span class="p">)</span>
      <span class="k">print</span><span class="p">(</span><span class="s">&quot;Please download the latest Java SE JDK 7 from the following URL:&quot;</span><span class="p">)</span>
      <span class="k">print</span><span class="p">(</span><span class="s">&quot;http://www.oracle.com/technetwork/java/javase/downloads/jdk7-downloads-1880260.html&quot;</span><span class="p">)</span>
      <span class="k">print</span><span class="p">()</span>

    <span class="n">vm_opts</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">if</span> <span class="n">mmin</span><span class="p">:</span> <span class="n">vm_opts</span> <span class="o">+=</span> <span class="p">[</span><span class="s">&quot;-Xms{}g&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">mmin</span><span class="p">)]</span>
    <span class="k">if</span> <span class="n">mmax</span><span class="p">:</span> <span class="n">vm_opts</span> <span class="o">+=</span> <span class="p">[</span><span class="s">&quot;-Xmx{}g&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">mmax</span><span class="p">)]</span>
    <span class="k">if</span> <span class="n">ea</span><span class="p">:</span>   <span class="n">vm_opts</span> <span class="o">+=</span> <span class="p">[</span><span class="s">&quot;-ea&quot;</span><span class="p">]</span>

    <span class="n">h2o_opts</span> <span class="o">=</span> <span class="p">[</span><span class="s">&quot;-verbose:gc&quot;</span><span class="p">,</span>
                <span class="s">&quot;-XX:+PrintGCDetails&quot;</span><span class="p">,</span>
                <span class="s">&quot;-XX:+PrintGCTimeStamps&quot;</span><span class="p">,</span>
                <span class="s">&quot;-jar&quot;</span><span class="p">,</span> <span class="n">jar_path</span><span class="p">,</span>
                <span class="s">&quot;-name&quot;</span><span class="p">,</span> <span class="s">&quot;H2O_started_from_python_&quot;</span> 
                <span class="o">+</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="s">&quot;[^A-Za-z0-9]&quot;</span><span class="p">,</span> <span class="s">&quot;_&quot;</span><span class="p">,</span> 
                         <span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">getenv</span><span class="p">(</span><span class="s">&quot;USERNAME&quot;</span><span class="p">)</span> <span class="k">if</span> <span class="n">sys</span><span class="o">.</span><span class="n">platform</span> <span class="o">==</span> <span class="s">&quot;win32&quot;</span> <span class="k">else</span> <span class="n">os</span><span class="o">.</span><span class="n">getenv</span><span class="p">(</span><span class="s">&quot;USER&quot;</span><span class="p">))</span> <span class="ow">or</span> <span class="s">&quot;unknownUser&quot;</span><span class="p">)</span>
                <span class="o">+</span> <span class="s">&quot;_&quot;</span> <span class="o">+</span> <span class="s">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">choice</span><span class="p">(</span><span class="n">ascii_lowercase</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">)]</span> <span class="o">+</span> <span class="p">[</span><span class="n">choice</span><span class="p">(</span><span class="n">digits</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">)]),</span>
                <span class="s">&quot;-ip&quot;</span><span class="p">,</span> <span class="s">&quot;127.0.0.1&quot;</span><span class="p">,</span>
                <span class="s">&quot;-port&quot;</span><span class="p">,</span> <span class="s">&quot;54321&quot;</span><span class="p">,</span>
                <span class="s">&quot;-ice_root&quot;</span><span class="p">,</span> <span class="n">ice</span><span class="p">,</span>
                <span class="p">]</span>
    
    <span class="k">if</span> <span class="n">nthreads</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span> <span class="n">h2o_opts</span> <span class="o">+=</span>  <span class="p">[</span><span class="s">&quot;-nthreads&quot;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">nthreads</span><span class="p">)]</span>
    <span class="k">if</span> <span class="n">license</span><span class="p">:</span> <span class="n">h2o_opts</span> <span class="o">+=</span> <span class="p">[</span><span class="s">&quot;-license&quot;</span><span class="p">,</span> <span class="n">license</span><span class="p">]</span>

    <span class="n">cmd</span> <span class="o">=</span> <span class="p">[</span><span class="n">command</span><span class="p">]</span> <span class="o">+</span> <span class="n">vm_opts</span> <span class="o">+</span> <span class="n">h2o_opts</span>

    <span class="n">cwd</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">())</span>
    <span class="k">if</span> <span class="n">sys</span><span class="o">.</span><span class="n">platform</span> <span class="o">==</span> <span class="s">&quot;win32&quot;</span><span class="p">:</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">_child</span> <span class="o">=</span> <span class="n">subprocess</span><span class="o">.</span><span class="n">Popen</span><span class="p">(</span><span class="n">args</span><span class="o">=</span><span class="n">cmd</span><span class="p">,</span><span class="n">stdout</span><span class="o">=</span><span class="n">stdout</span><span class="p">,</span><span class="n">stderr</span><span class="o">=</span><span class="n">stderr</span><span class="p">,</span><span class="n">cwd</span><span class="o">=</span><span class="n">cwd</span><span class="p">,</span><span class="n">creationflags</span><span class="o">=</span><span class="n">subprocess</span><span class="o">.</span><span class="n">CREATE_NEW_PROCESS_GROUP</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">_child</span> <span class="o">=</span> <span class="n">subprocess</span><span class="o">.</span><span class="n">Popen</span><span class="p">(</span><span class="n">args</span><span class="o">=</span><span class="n">cmd</span><span class="p">,</span> <span class="n">stdout</span><span class="o">=</span><span class="n">stdout</span><span class="p">,</span> <span class="n">stderr</span><span class="o">=</span><span class="n">stderr</span><span class="p">,</span> <span class="n">cwd</span><span class="o">=</span><span class="n">cwd</span><span class="p">,</span> <span class="n">preexec_fn</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">setsid</span><span class="p">)</span>
    <span class="n">cld</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_connect</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="bp">True</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">cld</span>

  <span class="nd">@staticmethod</span>
  <span class="k">def</span> <span class="nf">_check_java</span><span class="p">():</span>
    <span class="c"># *WARNING* some over-engineering follows... :{</span>

    <span class="c"># is java in PATH?</span>
    <span class="k">if</span> <span class="n">H2OConnection</span><span class="o">.</span><span class="n">_pwhich</span><span class="p">(</span><span class="s">&quot;java&quot;</span><span class="p">):</span>
      <span class="k">return</span> <span class="n">H2OConnection</span><span class="o">.</span><span class="n">_pwhich</span><span class="p">(</span><span class="s">&quot;java&quot;</span><span class="p">)</span>

    <span class="c"># check if JAVA_HOME is set (for windoz)</span>
    <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">getenv</span><span class="p">(</span><span class="s">&quot;JAVA_HOME&quot;</span><span class="p">):</span>
      <span class="k">return</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">getenv</span><span class="p">(</span><span class="s">&quot;JAVA_HOME&quot;</span><span class="p">),</span> <span class="s">&quot;bin&quot;</span><span class="p">,</span> <span class="s">&quot;java.exe&quot;</span><span class="p">)</span>

    <span class="c"># check /Program Files/ and /Program Files (x86)/ if os is windoz</span>
    <span class="k">if</span> <span class="n">sys</span><span class="o">.</span><span class="n">platform</span> <span class="o">==</span> <span class="s">&quot;win32&quot;</span><span class="p">:</span>
      <span class="n">program_folder</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s">&quot;C:&quot;</span><span class="p">,</span> <span class="s">&quot;{}&quot;</span><span class="p">,</span> <span class="s">&quot;Java&quot;</span><span class="p">)</span>
      <span class="n">program_folders</span> <span class="o">=</span> <span class="p">[</span><span class="n">program_folder</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s">&quot;Program Files&quot;</span><span class="p">),</span>
                         <span class="n">program_folder</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s">&quot;Program Files (x86)&quot;</span><span class="p">)]</span>

      <span class="c"># check both possible program files...</span>
      <span class="k">for</span> <span class="n">folder</span> <span class="ow">in</span> <span class="n">program_folders</span><span class="p">:</span>

        <span class="c"># hunt down the jdk directory</span>
        <span class="n">possible_jdk_dir</span> <span class="o">=</span> <span class="p">[</span><span class="n">d</span> <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">folder</span> <span class="k">if</span> <span class="s">&#39;jdk&#39;</span> <span class="ow">in</span> <span class="n">d</span><span class="p">]</span>

        <span class="c"># if got a non-empty list of jdk directory candidates</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">possible_jdk_dir</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>

          <span class="c"># loop over and check if the java.exe exists</span>
          <span class="k">for</span> <span class="n">jdk</span> <span class="ow">in</span> <span class="n">possible_jdk_dir</span><span class="p">:</span>
            <span class="n">path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">folder</span><span class="p">,</span> <span class="n">jdk</span><span class="p">,</span> <span class="s">&quot;bin&quot;</span><span class="p">,</span> <span class="s">&quot;java.exe&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">path</span><span class="p">):</span>
              <span class="k">return</span> <span class="n">path</span>

      <span class="c"># check for JRE and warn</span>
      <span class="k">for</span> <span class="n">folder</span> <span class="ow">in</span> <span class="n">program_folders</span><span class="p">:</span>
        <span class="n">path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">folder</span><span class="p">,</span> <span class="s">&quot;jre7&quot;</span><span class="p">,</span> <span class="s">&quot;bin&quot;</span><span class="p">,</span> <span class="s">&quot;java.exe&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">path</span><span class="p">):</span>
          <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&quot;Found JRE at &quot;</span> <span class="o">+</span> <span class="n">path</span> <span class="o">+</span> <span class="s">&quot;; but H2O requires the JDK to run.&quot;</span><span class="p">)</span>

    <span class="k">else</span><span class="p">:</span>
      <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&quot;Cannot find Java. Please install the latest JDK from</span><span class="se">\n</span><span class="s">&quot;</span>
        <span class="o">+</span><span class="s">&quot;http://www.oracle.com/technetwork/java/javase/downloads/index.html&quot;</span> <span class="p">)</span>

  <span class="nd">@staticmethod</span>
  <span class="k">def</span> <span class="nf">_pwhich</span><span class="p">(</span><span class="n">e</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    POSIX style which</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">ok</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">X_OK</span>
    <span class="k">if</span> <span class="n">e</span><span class="p">:</span>
      <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">access</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="n">ok</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">e</span>
      <span class="k">for</span> <span class="n">path</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">getenv</span><span class="p">(</span><span class="s">&#39;PATH&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">pathsep</span><span class="p">):</span>
        <span class="n">full_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">access</span><span class="p">(</span><span class="n">full_path</span><span class="p">,</span> <span class="n">ok</span><span class="p">):</span>
          <span class="k">return</span> <span class="n">full_path</span>
    <span class="k">return</span> <span class="bp">None</span>

  <span class="nd">@staticmethod</span>
  <span class="k">def</span> <span class="nf">_tmp_file</span><span class="p">(</span><span class="nb">type</span><span class="p">):</span>
    <span class="n">usr</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="s">&quot;[^A-Za-z0-9]&quot;</span><span class="p">,</span> <span class="s">&quot;_&quot;</span><span class="p">,</span> <span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">getenv</span><span class="p">(</span><span class="s">&quot;USERNAME&quot;</span><span class="p">)</span> <span class="k">if</span> <span class="n">sys</span><span class="o">.</span><span class="n">platform</span> <span class="o">==</span> <span class="s">&quot;win32&quot;</span> <span class="k">else</span> <span class="n">os</span><span class="o">.</span><span class="n">getenv</span><span class="p">(</span><span class="s">&quot;USER&quot;</span><span class="p">))</span> <span class="ow">or</span> <span class="s">&quot;unknownUser&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">type</span> <span class="o">==</span> <span class="s">&quot;stdout&quot;</span><span class="p">:</span>
      <span class="n">path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">tempfile</span><span class="o">.</span><span class="n">mkdtemp</span><span class="p">(),</span> <span class="s">&quot;h2o_{}_started_from_python.out&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">usr</span><span class="p">))</span>
      <span class="k">print</span><span class="p">(</span><span class="s">&quot;JVM stdout: &quot;</span> <span class="o">+</span> <span class="n">path</span><span class="p">)</span>
      <span class="k">return</span> <span class="n">path</span>
    <span class="k">if</span> <span class="nb">type</span> <span class="o">==</span> <span class="s">&quot;stderr&quot;</span><span class="p">:</span>
      <span class="n">path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">tempfile</span><span class="o">.</span><span class="n">mkdtemp</span><span class="p">(),</span> <span class="s">&quot;h2o_{}_started_from_python.err&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">usr</span><span class="p">))</span>
      <span class="k">print</span><span class="p">(</span><span class="s">&quot;JVM stderr: &quot;</span> <span class="o">+</span> <span class="n">path</span><span class="p">)</span>
      <span class="k">return</span> <span class="n">path</span>
    <span class="k">if</span> <span class="nb">type</span> <span class="o">==</span> <span class="s">&quot;pid&quot;</span><span class="p">:</span>
      <span class="k">return</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">tempfile</span><span class="o">.</span><span class="n">mkdtemp</span><span class="p">(),</span> <span class="s">&quot;h2o_{}_started_from_python.pid&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">usr</span><span class="p">))</span>

    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&quot;Unkown type in H2OConnection._tmp_file call: &quot;</span> <span class="o">+</span> <span class="nb">type</span><span class="p">)</span>

  <span class="nd">@staticmethod</span>
  <span class="k">def</span> <span class="nf">_shutdown</span><span class="p">(</span><span class="n">conn</span><span class="p">,</span> <span class="n">prompt</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Shut down the specified instance. All data will be lost.</span>
<span class="sd">    This method checks if H2O is running at the specified IP address and port, and if it is, shuts down that H2O</span>
<span class="sd">    instance.</span>
<span class="sd">    :param conn: An H2OConnection object containing the IP address and port of the server running H2O.</span>
<span class="sd">    :param prompt: A logical value indicating whether to prompt the user before shutting down the H2O server.</span>
<span class="sd">    :return: None</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">global</span> <span class="n">__H2OCONN__</span>
    <span class="k">if</span> <span class="n">conn</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span> <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&quot;There is no H2O instance running.&quot;</span><span class="p">)</span>
    <span class="k">try</span><span class="p">:</span>
      <span class="k">if</span> <span class="ow">not</span> <span class="n">conn</span><span class="o">.</span><span class="n">cluster_is_up</span><span class="p">(</span><span class="n">conn</span><span class="p">):</span>  <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&quot;There is no H2O instance running at ip: {0} and port: &quot;</span>
                                                       <span class="s">&quot;{1}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">conn</span><span class="o">.</span><span class="n">ip</span><span class="p">(),</span> <span class="n">conn</span><span class="o">.</span><span class="n">port</span><span class="p">()))</span>
    <span class="k">except</span><span class="p">:</span>
      <span class="c">#H2O is already shutdown on the java side</span>
      <span class="n">ip</span> <span class="o">=</span> <span class="n">conn</span><span class="o">.</span><span class="n">ip</span><span class="p">()</span>
      <span class="n">port</span> <span class="o">=</span> <span class="n">conn</span><span class="o">.</span><span class="n">port</span><span class="p">()</span>
      <span class="n">__H2OCONN__</span><span class="o">=</span> <span class="bp">None</span>
      <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&quot;The H2O instance running at {0}:{1} has already been shutdown.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">ip</span><span class="p">,</span> <span class="n">port</span><span class="p">))</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">prompt</span><span class="p">,</span> <span class="nb">bool</span><span class="p">):</span> <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&quot;`prompt` must be TRUE or FALSE&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">prompt</span><span class="p">:</span>
      <span class="n">question</span> <span class="o">=</span> <span class="s">&quot;Are you sure you want to shutdown the H2O instance running at {0}:{1} (Y/N)? &quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">conn</span><span class="o">.</span><span class="n">ip</span><span class="p">(),</span> <span class="n">conn</span><span class="o">.</span><span class="n">port</span><span class="p">())</span>
      <span class="n">response</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="n">question</span><span class="p">)</span> <span class="k">if</span> <span class="n">PY3</span> <span class="k">else</span> <span class="nb">raw_input</span><span class="p">(</span><span class="n">question</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span> <span class="n">response</span> <span class="o">=</span> <span class="s">&quot;Y&quot;</span>
    <span class="k">if</span> <span class="n">response</span> <span class="o">==</span> <span class="s">&quot;Y&quot;</span> <span class="ow">or</span> <span class="n">response</span> <span class="o">==</span> <span class="s">&quot;y&quot;</span><span class="p">:</span> 
      <span class="n">conn</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="n">url_suffix</span><span class="o">=</span><span class="s">&quot;Shutdown&quot;</span><span class="p">)</span>
      <span class="n">__H2OCONN__</span> <span class="o">=</span> <span class="bp">None</span> <span class="c">#so that the &quot;Did you run `h2o.init()`&quot; ValueError is triggered</span>

  <span class="nd">@staticmethod</span>
<div class="viewcode-block" id="H2OConnection.rest_version"><a class="viewcode-back" href="../../other.html#h2o.connection.H2OConnection.rest_version">[docs]</a>  <span class="k">def</span> <span class="nf">rest_version</span><span class="p">():</span> <span class="k">return</span> <span class="n">__H2OCONN__</span><span class="o">.</span><span class="n">_rest_version</span></div>

  <span class="nd">@staticmethod</span>
<div class="viewcode-block" id="H2OConnection.session_id"><a class="viewcode-back" href="../../other.html#h2o.connection.H2OConnection.session_id">[docs]</a>  <span class="k">def</span> <span class="nf">session_id</span><span class="p">():</span> <span class="k">return</span> <span class="n">__H2OCONN__</span><span class="o">.</span><span class="n">_session_id</span></div>

  <span class="nd">@staticmethod</span>
<div class="viewcode-block" id="H2OConnection.port"><a class="viewcode-back" href="../../other.html#h2o.connection.H2OConnection.port">[docs]</a>  <span class="k">def</span> <span class="nf">port</span><span class="p">():</span> <span class="k">return</span> <span class="n">__H2OCONN__</span><span class="o">.</span><span class="n">_port</span></div>

  <span class="nd">@staticmethod</span>
<div class="viewcode-block" id="H2OConnection.ip"><a class="viewcode-back" href="../../other.html#h2o.connection.H2OConnection.ip">[docs]</a>  <span class="k">def</span> <span class="nf">ip</span><span class="p">():</span> <span class="k">return</span> <span class="n">__H2OCONN__</span><span class="o">.</span><span class="n">_ip</span></div>
  
  <span class="nd">@staticmethod</span>
<div class="viewcode-block" id="H2OConnection.https"><a class="viewcode-back" href="../../other.html#h2o.connection.H2OConnection.https">[docs]</a>  <span class="k">def</span> <span class="nf">https</span><span class="p">():</span> <span class="k">return</span>  <span class="n">__H2OCONN__</span><span class="o">.</span><span class="n">_https</span></div>
  
  <span class="nd">@staticmethod</span>
<div class="viewcode-block" id="H2OConnection.username"><a class="viewcode-back" href="../../other.html#h2o.connection.H2OConnection.username">[docs]</a>  <span class="k">def</span> <span class="nf">username</span><span class="p">():</span> <span class="k">return</span> <span class="n">__H2OCONN__</span><span class="o">.</span><span class="n">_username</span></div>
  
  <span class="nd">@staticmethod</span>
<div class="viewcode-block" id="H2OConnection.password"><a class="viewcode-back" href="../../other.html#h2o.connection.H2OConnection.password">[docs]</a>  <span class="k">def</span> <span class="nf">password</span><span class="p">():</span> <span class="k">return</span> <span class="n">__H2OCONN__</span><span class="o">.</span><span class="n">_password</span></div>
  
  <span class="nd">@staticmethod</span>
<div class="viewcode-block" id="H2OConnection.insecure"><a class="viewcode-back" href="../../other.html#h2o.connection.H2OConnection.insecure">[docs]</a>  <span class="k">def</span> <span class="nf">insecure</span><span class="p">():</span> <span class="k">return</span> <span class="n">__H2OCONN__</span><span class="o">.</span><span class="n">_insecure</span></div>

  <span class="nd">@staticmethod</span>
<div class="viewcode-block" id="H2OConnection.current_connection"><a class="viewcode-back" href="../../other.html#h2o.connection.H2OConnection.current_connection">[docs]</a>  <span class="k">def</span> <span class="nf">current_connection</span><span class="p">():</span> <span class="k">return</span> <span class="n">__H2OCONN__</span></div>

  <span class="nd">@staticmethod</span>
<div class="viewcode-block" id="H2OConnection.check_conn"><a class="viewcode-back" href="../../other.html#h2o.connection.H2OConnection.check_conn">[docs]</a>  <span class="k">def</span> <span class="nf">check_conn</span><span class="p">():</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">__H2OCONN__</span><span class="p">:</span>
      <span class="k">raise</span> <span class="ne">EnvironmentError</span><span class="p">(</span><span class="s">&quot;No active connection to an H2O cluster.  Try calling `h2o.init()`&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">__H2OCONN__</span></div>

  <span class="nd">@staticmethod</span>
<div class="viewcode-block" id="H2OConnection.cluster_is_up"><a class="viewcode-back" href="../../other.html#h2o.connection.H2OConnection.cluster_is_up">[docs]</a>  <span class="k">def</span> <span class="nf">cluster_is_up</span><span class="p">(</span><span class="n">conn</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Determine if an H2O cluster is up or not</span>
<span class="sd">    :param conn: An H2OConnection object containing the IP address and port of the server running H2O.</span>
<span class="sd">    :return: TRUE if the cluster is up; FALSE otherwise</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">conn</span><span class="p">,</span> <span class="n">H2OConnection</span><span class="p">):</span> <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&quot;`conn` must be an H2OConnection object&quot;</span><span class="p">)</span>
    <span class="n">rv</span> <span class="o">=</span> <span class="n">conn</span><span class="o">.</span><span class="n">current_connection</span><span class="p">()</span><span class="o">.</span><span class="n">_attempt_rest</span><span class="p">(</span><span class="n">url</span><span class="o">=</span><span class="p">(</span><span class="s">&quot;https&quot;</span> <span class="k">if</span> <span class="n">conn</span><span class="o">.</span><span class="n">https</span><span class="p">()</span> <span class="k">else</span> <span class="s">&quot;http&quot;</span><span class="p">)</span> <span class="o">+</span><span class="s">&quot;://{0}:{1}/&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">conn</span><span class="o">.</span><span class="n">ip</span><span class="p">(),</span> <span class="n">conn</span><span class="o">.</span><span class="n">port</span><span class="p">()),</span> <span class="n">method</span><span class="o">=</span><span class="s">&quot;GET&quot;</span><span class="p">,</span>
                                                 <span class="n">post_body</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span> <span class="n">file_upload_info</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">rv</span><span class="o">.</span><span class="n">status_code</span> <span class="o">==</span> <span class="mi">401</span><span class="p">:</span> <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s">&quot;401 Unauthorized Access. Did you forget to provide a username and password?&quot;</span><span class="p">)</span> 
    <span class="k">return</span> <span class="n">rv</span><span class="o">.</span><span class="n">status_code</span> <span class="o">==</span> <span class="mi">200</span> <span class="ow">or</span> <span class="n">rv</span><span class="o">.</span><span class="n">status_code</span> <span class="o">==</span> <span class="mi">301</span></div>

  <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">  Below is the REST implementation layer:</span>
<span class="sd">      _attempt_rest -- GET, POST, DELETE</span>

<span class="sd">      _do_raw_rest</span>

<span class="sd">      get</span>
<span class="sd">      post</span>
<span class="sd">      get_json</span>
<span class="sd">      post_json</span>

<span class="sd">  All methods are static and rely on an active __H2OCONN__ object.</span>
<span class="sd">  &quot;&quot;&quot;</span>

  <span class="nd">@staticmethod</span>
<div class="viewcode-block" id="H2OConnection.make_url"><a class="viewcode-back" href="../../other.html#h2o.connection.H2OConnection.make_url">[docs]</a>  <span class="k">def</span> <span class="nf">make_url</span><span class="p">(</span><span class="n">url_suffix</span><span class="p">,</span> <span class="n">_rest_version</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="n">scheme</span> <span class="o">=</span> <span class="s">&quot;https&quot;</span> <span class="k">if</span> <span class="n">H2OConnection</span><span class="o">.</span><span class="n">https</span><span class="p">()</span> <span class="k">else</span> <span class="s">&quot;http&quot;</span> 
    <span class="n">_rest_version</span> <span class="o">=</span> <span class="n">_rest_version</span> <span class="ow">or</span> <span class="n">H2OConnection</span><span class="o">.</span><span class="n">rest_version</span><span class="p">()</span>
    <span class="k">return</span> <span class="s">&quot;{}://{}:{}/{}/{}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">scheme</span><span class="p">,</span><span class="n">H2OConnection</span><span class="o">.</span><span class="n">ip</span><span class="p">(),</span><span class="n">H2OConnection</span><span class="o">.</span><span class="n">port</span><span class="p">(),</span><span class="n">_rest_version</span><span class="p">,</span><span class="n">url_suffix</span><span class="p">)</span></div>

  <span class="nd">@staticmethod</span>
<div class="viewcode-block" id="H2OConnection.get"><a class="viewcode-back" href="../../other.html#h2o.connection.H2OConnection.get">[docs]</a>  <span class="k">def</span> <span class="nf">get</span><span class="p">(</span><span class="n">url_suffix</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">__H2OCONN__</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
      <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&quot;No h2o connection. Did you run `h2o.init()` ?&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">__H2OCONN__</span><span class="o">.</span><span class="n">_do_raw_rest</span><span class="p">(</span><span class="n">url_suffix</span><span class="p">,</span> <span class="s">&quot;GET&quot;</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>

  <span class="nd">@staticmethod</span>
<div class="viewcode-block" id="H2OConnection.post"><a class="viewcode-back" href="../../other.html#h2o.connection.H2OConnection.post">[docs]</a>  <span class="k">def</span> <span class="nf">post</span><span class="p">(</span><span class="n">url_suffix</span><span class="p">,</span> <span class="n">file_upload_info</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">__H2OCONN__</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
      <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&quot;No h2o connection. Did you run `h2o.init()` ?&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">__H2OCONN__</span><span class="o">.</span><span class="n">_do_raw_rest</span><span class="p">(</span><span class="n">url_suffix</span><span class="p">,</span> <span class="s">&quot;POST&quot;</span><span class="p">,</span> <span class="n">file_upload_info</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>

  <span class="nd">@staticmethod</span>
<div class="viewcode-block" id="H2OConnection.delete"><a class="viewcode-back" href="../../other.html#h2o.connection.H2OConnection.delete">[docs]</a>  <span class="k">def</span> <span class="nf">delete</span><span class="p">(</span><span class="n">url_suffix</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">__H2OCONN__</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
      <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&quot;No h2o connection. Did you run `h2o.init()` ?&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">__H2OCONN__</span><span class="o">.</span><span class="n">_do_raw_rest</span><span class="p">(</span><span class="n">url_suffix</span><span class="p">,</span> <span class="s">&quot;DELETE&quot;</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>

  <span class="nd">@staticmethod</span>
<div class="viewcode-block" id="H2OConnection.get_json"><a class="viewcode-back" href="../../other.html#h2o.connection.H2OConnection.get_json">[docs]</a>  <span class="k">def</span> <span class="nf">get_json</span><span class="p">(</span><span class="n">url_suffix</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">__H2OCONN__</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
      <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&quot;No h2o connection. Did you run `h2o.init()` ?&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">__H2OCONN__</span><span class="o">.</span><span class="n">_rest_json</span><span class="p">(</span><span class="n">url_suffix</span><span class="p">,</span> <span class="s">&quot;GET&quot;</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>

  <span class="nd">@staticmethod</span>
<div class="viewcode-block" id="H2OConnection.post_json"><a class="viewcode-back" href="../../other.html#h2o.connection.H2OConnection.post_json">[docs]</a>  <span class="k">def</span> <span class="nf">post_json</span><span class="p">(</span><span class="n">url_suffix</span><span class="p">,</span> <span class="n">file_upload_info</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">__H2OCONN__</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
      <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&quot;No h2o connection. Did you run `h2o.init()` ?&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">__H2OCONN__</span><span class="o">.</span><span class="n">_rest_json</span><span class="p">(</span><span class="n">url_suffix</span><span class="p">,</span> <span class="s">&quot;POST&quot;</span><span class="p">,</span> <span class="n">file_upload_info</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>

  <span class="k">def</span> <span class="nf">_rest_json</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">url_suffix</span><span class="p">,</span> <span class="n">method</span><span class="p">,</span> <span class="n">file_upload_info</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="n">raw_txt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_do_raw_rest</span><span class="p">(</span><span class="n">url_suffix</span><span class="p">,</span> <span class="n">method</span><span class="p">,</span> <span class="n">file_upload_info</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_process_tables</span><span class="p">(</span><span class="n">raw_txt</span><span class="o">.</span><span class="n">json</span><span class="p">())</span>

  <span class="c"># Massage arguments into place, call _attempt_rest</span>
  <span class="k">def</span> <span class="nf">_do_raw_rest</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">url_suffix</span><span class="p">,</span> <span class="n">method</span><span class="p">,</span> <span class="n">file_upload_info</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">url_suffix</span><span class="p">:</span>
      <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&quot;No url suffix supplied.&quot;</span><span class="p">)</span>

    <span class="c"># allow override of REST version, currently used for Rapids which is /99</span>
    <span class="k">if</span> <span class="s">&#39;_rest_version&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
      <span class="n">_rest_version</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s">&#39;_rest_version&#39;</span><span class="p">]</span>
      <span class="k">del</span> <span class="n">kwargs</span><span class="p">[</span><span class="s">&#39;_rest_version&#39;</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
      <span class="n">_rest_version</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rest_version</span>

    <span class="n">url</span> <span class="o">=</span> <span class="n">H2OConnection</span><span class="o">.</span><span class="n">make_url</span><span class="p">(</span><span class="n">url_suffix</span><span class="p">,</span><span class="n">_rest_version</span><span class="p">)</span>
    
    <span class="n">query_string</span> <span class="o">=</span> <span class="s">&quot;&quot;</span>
    <span class="k">for</span> <span class="n">k</span><span class="p">,</span><span class="n">v</span> <span class="ow">in</span> <span class="n">iteritems</span><span class="p">(</span><span class="n">kwargs</span><span class="p">):</span>
      <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
        <span class="n">x</span> <span class="o">=</span> <span class="s">&#39;[&#39;</span>
        <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="n">v</span><span class="p">:</span>
          <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">l</span><span class="p">,</span><span class="nb">list</span><span class="p">):</span>
            <span class="n">x</span> <span class="o">+=</span> <span class="s">&#39;[&#39;</span>
            <span class="n">x</span> <span class="o">+=</span> <span class="s">&#39;,&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span> <span class="k">if</span> <span class="n">PY3</span> <span class="k">else</span> <span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="n">H2OConnection</span><span class="o">.</span><span class="n">__ENCODING__</span><span class="p">,</span> <span class="n">errors</span><span class="o">=</span><span class="n">H2OConnection</span><span class="o">.</span><span class="n">__ENCODING_ERROR__</span><span class="p">)</span> <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">l</span><span class="p">])</span>
            <span class="n">x</span> <span class="o">+=</span> <span class="s">&#39;]&#39;</span>
          <span class="k">else</span><span class="p">:</span>
            <span class="n">x</span> <span class="o">+=</span> <span class="nb">str</span><span class="p">(</span><span class="n">l</span><span class="p">)</span> <span class="k">if</span> <span class="n">PY3</span> <span class="k">else</span> <span class="nb">str</span><span class="p">(</span><span class="n">l</span><span class="p">)</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="n">H2OConnection</span><span class="o">.</span><span class="n">__ENCODING__</span><span class="p">,</span> <span class="n">errors</span><span class="o">=</span><span class="n">H2OConnection</span><span class="o">.</span><span class="n">__ENCODING_ERROR__</span><span class="p">)</span>
          <span class="n">x</span> <span class="o">+=</span> <span class="s">&#39;,&#39;</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">x</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">x</span> <span class="o">+=</span> <span class="s">&#39;]&#39;</span>
      <span class="k">else</span><span class="p">:</span>
        <span class="n">x</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">v</span><span class="p">)</span> <span class="k">if</span> <span class="n">PY3</span> <span class="k">else</span> <span class="nb">str</span><span class="p">(</span><span class="n">v</span><span class="p">)</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="n">H2OConnection</span><span class="o">.</span><span class="n">__ENCODING__</span><span class="p">,</span> <span class="n">errors</span><span class="o">=</span><span class="n">H2OConnection</span><span class="o">.</span><span class="n">__ENCODING_ERROR__</span><span class="p">)</span>
      <span class="n">query_string</span> <span class="o">+=</span> <span class="n">k</span><span class="o">+</span><span class="s">&quot;=&quot;</span><span class="o">+</span><span class="n">quote</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">+</span><span class="s">&quot;&amp;&quot;</span>
    <span class="n">query_string</span> <span class="o">=</span> <span class="n">query_string</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>  <span class="c"># Remove trailing extra &amp;</span>

    <span class="n">post_body</span> <span class="o">=</span> <span class="s">&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">file_upload_info</span><span class="p">:</span>
      <span class="k">if</span> <span class="n">method</span> <span class="o">==</span> <span class="s">&quot;POST&quot;</span><span class="p">:</span>
        <span class="n">post_body</span> <span class="o">=</span> <span class="n">query_string</span>
      <span class="k">elif</span> <span class="n">query_string</span> <span class="o">!=</span> <span class="s">&#39;&#39;</span><span class="p">:</span>
        <span class="n">url</span> <span class="o">=</span> <span class="s">&quot;{}?{}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">query_string</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
      <span class="k">if</span> <span class="ow">not</span> <span class="n">method</span> <span class="o">==</span> <span class="s">&quot;POST&quot;</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&quot;Received file upload info and expected method to be POST. Got: &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">method</span><span class="p">))</span>
      <span class="k">if</span> <span class="n">query_string</span> <span class="o">!=</span> <span class="s">&#39;&#39;</span><span class="p">:</span>
        <span class="n">url</span> <span class="o">=</span> <span class="s">&quot;{}?{}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">query_string</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">_is_logging</span><span class="p">():</span>
      <span class="n">_log_rest</span><span class="p">(</span><span class="s">&quot;------------------------------------------------------------</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>
      <span class="n">_log_rest</span><span class="p">(</span><span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>
      <span class="n">_log_rest</span><span class="p">(</span><span class="s">&quot;Time:     {0}</span><span class="se">\n</span><span class="s">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s">&#39;Y-%m-</span><span class="si">%d</span><span class="s"> %H:%M:%OS3&#39;</span><span class="p">)))</span>
      <span class="n">_log_rest</span><span class="p">(</span><span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>
      <span class="n">_log_rest</span><span class="p">(</span><span class="s">&quot;{0} {1}</span><span class="se">\n</span><span class="s">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">method</span><span class="p">,</span> <span class="n">url</span><span class="p">))</span>
      <span class="n">_log_rest</span><span class="p">(</span><span class="s">&quot;postBody: {0}</span><span class="se">\n</span><span class="s">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">post_body</span><span class="p">))</span>

    <span class="k">global</span> <span class="n">_rest_ctr</span><span class="p">;</span> <span class="n">_rest_ctr</span> <span class="o">=</span> <span class="n">_rest_ctr</span><span class="o">+</span><span class="mi">1</span>
    <span class="n">begin_time_seconds</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
    <span class="n">http_result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_attempt_rest</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">method</span><span class="p">,</span> <span class="n">post_body</span><span class="p">,</span> <span class="n">file_upload_info</span><span class="p">)</span>
    <span class="n">end_time_seconds</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
    <span class="n">elapsed_time_seconds</span> <span class="o">=</span> <span class="n">end_time_seconds</span> <span class="o">-</span> <span class="n">begin_time_seconds</span>
    <span class="n">elapsed_time_millis</span> <span class="o">=</span> <span class="n">elapsed_time_seconds</span> <span class="o">*</span> <span class="mi">1000</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">http_result</span><span class="o">.</span><span class="n">ok</span><span class="p">:</span>
      <span class="n">detailed_error_msgs</span> <span class="o">=</span> <span class="p">[]</span>
      <span class="k">try</span><span class="p">:</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">http_result</span><span class="o">.</span><span class="n">json</span><span class="p">()</span>
        <span class="k">if</span> <span class="s">&#39;messages&#39;</span> <span class="ow">in</span> <span class="n">result</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
          <span class="n">detailed_error_msgs</span> <span class="o">=</span> <span class="s">&#39;</span><span class="se">\n</span><span class="s">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">m</span><span class="p">[</span><span class="s">&#39;message&#39;</span><span class="p">]</span> <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="n">result</span><span class="p">[</span><span class="s">&#39;messages&#39;</span><span class="p">]</span> <span class="k">if</span> <span class="n">m</span><span class="p">[</span><span class="s">&#39;message_type&#39;</span><span class="p">]</span> <span class="ow">in</span> <span class="p">[</span><span class="s">&#39;ERRR&#39;</span><span class="p">]])</span>
        <span class="k">elif</span> <span class="s">&#39;exception_msg&#39;</span> <span class="ow">in</span> <span class="n">result</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
          <span class="n">detailed_error_msgs</span> <span class="o">=</span> <span class="n">result</span><span class="p">[</span><span class="s">&#39;exception_msg&#39;</span><span class="p">]</span>
      <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
        <span class="k">pass</span>
      <span class="k">raise</span> <span class="ne">EnvironmentError</span><span class="p">((</span><span class="s">&quot;h2o-py got an unexpected HTTP status code:</span><span class="se">\n</span><span class="s"> {} {} (method = {}; url = {}). </span><span class="se">\n</span><span class="s">&quot;</span><span class="o">+</span> \
                              <span class="s">&quot;detailed error messages: {}&quot;</span><span class="p">)</span>
                              <span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">http_result</span><span class="o">.</span><span class="n">status_code</span><span class="p">,</span><span class="n">http_result</span><span class="o">.</span><span class="n">reason</span><span class="p">,</span><span class="n">method</span><span class="p">,</span><span class="n">url</span><span class="p">,</span><span class="n">detailed_error_msgs</span><span class="p">))</span>


    <span class="k">if</span> <span class="n">_is_logging</span><span class="p">():</span>
      <span class="n">_log_rest</span><span class="p">(</span><span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>
      <span class="n">_log_rest</span><span class="p">(</span><span class="s">&quot;httpStatusCode:    {0}</span><span class="se">\n</span><span class="s">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">http_result</span><span class="o">.</span><span class="n">status_code</span><span class="p">))</span>
      <span class="n">_log_rest</span><span class="p">(</span><span class="s">&quot;httpStatusMessage: {0}</span><span class="se">\n</span><span class="s">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">http_result</span><span class="o">.</span><span class="n">reason</span><span class="p">))</span>
      <span class="n">_log_rest</span><span class="p">(</span><span class="s">&quot;millis:            {0}</span><span class="se">\n</span><span class="s">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">elapsed_time_millis</span><span class="p">))</span>
      <span class="n">_log_rest</span><span class="p">(</span><span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>
      <span class="n">_log_rest</span><span class="p">(</span><span class="s">&quot;{0}</span><span class="se">\n</span><span class="s">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">http_result</span><span class="o">.</span><span class="n">json</span><span class="p">()))</span>
      <span class="n">_log_rest</span><span class="p">(</span><span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>


    <span class="k">return</span> <span class="n">http_result</span>

  <span class="c"># Low level request call</span>
  <span class="k">def</span> <span class="nf">_attempt_rest</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">url</span><span class="p">,</span> <span class="n">method</span><span class="p">,</span> <span class="n">post_body</span><span class="p">,</span> <span class="n">file_upload_info</span><span class="p">):</span>
    
    <span class="n">auth</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_username</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_password</span><span class="p">)</span>
    <span class="n">verify</span> <span class="o">=</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_insecure</span>
    <span class="n">headers</span> <span class="o">=</span> <span class="p">{</span><span class="s">&#39;User-Agent&#39;</span><span class="p">:</span> <span class="s">&#39;H2O Python client/&#39;</span><span class="o">+</span><span class="n">sys</span><span class="o">.</span><span class="n">version</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s">&#39;</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">,</span><span class="s">&#39;&#39;</span><span class="p">)}</span>
    <span class="k">try</span><span class="p">:</span>
      <span class="k">if</span> <span class="n">method</span> <span class="o">==</span> <span class="s">&quot;GET&quot;</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">,</span> <span class="n">proxies</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_proxy</span><span class="p">,</span> <span class="n">auth</span><span class="o">=</span><span class="n">auth</span><span class="p">,</span> <span class="n">verify</span><span class="o">=</span><span class="n">verify</span><span class="p">)</span>
      <span class="k">elif</span> <span class="n">file_upload_info</span><span class="p">:</span>
        <span class="n">files</span> <span class="o">=</span> <span class="p">{</span><span class="n">file_upload_info</span><span class="p">[</span><span class="s">&quot;file&quot;</span><span class="p">]</span> <span class="p">:</span> <span class="nb">open</span><span class="p">(</span><span class="n">file_upload_info</span><span class="p">[</span><span class="s">&quot;file&quot;</span><span class="p">],</span> <span class="s">&quot;rb&quot;</span><span class="p">)}</span>
        <span class="k">return</span> <span class="n">requests</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">files</span><span class="o">=</span><span class="n">files</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">,</span> <span class="n">proxies</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_proxy</span><span class="p">,</span> <span class="n">auth</span><span class="o">=</span><span class="n">auth</span><span class="p">,</span> <span class="n">verify</span><span class="o">=</span><span class="n">verify</span><span class="p">)</span>
      <span class="k">elif</span> <span class="n">method</span> <span class="o">==</span> <span class="s">&quot;POST&quot;</span><span class="p">:</span>
        <span class="n">headers</span><span class="p">[</span><span class="s">&quot;Content-Type&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s">&quot;application/x-www-form-urlencoded&quot;</span>
        <span class="k">return</span> <span class="n">requests</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">post_body</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">,</span> <span class="n">proxies</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_proxy</span><span class="p">,</span> <span class="n">auth</span><span class="o">=</span><span class="n">auth</span><span class="p">,</span> <span class="n">verify</span><span class="o">=</span><span class="n">verify</span><span class="p">)</span>
      <span class="k">elif</span> <span class="n">method</span> <span class="o">==</span> <span class="s">&quot;DELETE&quot;</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">requests</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">,</span> <span class="n">proxies</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_proxy</span><span class="p">,</span> <span class="n">auth</span><span class="o">=</span><span class="n">auth</span><span class="p">,</span> <span class="n">verify</span><span class="o">=</span><span class="n">verify</span><span class="p">)</span>
      <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&quot;Unknown HTTP method &quot;</span> <span class="o">+</span> <span class="n">method</span><span class="p">)</span>

    <span class="k">except</span> <span class="n">requests</span><span class="o">.</span><span class="n">ConnectionError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
      <span class="k">raise</span> <span class="ne">EnvironmentError</span><span class="p">(</span><span class="s">&quot;h2o-py encountered an unexpected HTTP error:</span><span class="se">\n</span><span class="s"> {}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">e</span><span class="p">))</span>

  <span class="c"># TODO:</span>
  <span class="c"># @staticmethod</span>
  <span class="c"># def _process_matrices(x=None):</span>
  <span class="c">#     if x:</span>
  <span class="c">#         if isinstance(x, &quot;dict&quot;):</span>
  <span class="c">#</span>
  <span class="c">#     return x</span>

  <span class="nd">@staticmethod</span>
  <span class="k">def</span> <span class="nf">_process_tables</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">x</span><span class="p">:</span>
      <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>

        <span class="n">has_meta</span> <span class="o">=</span> <span class="s">&quot;__meta&quot;</span> <span class="ow">in</span> <span class="n">x</span>
        <span class="n">has_schema_type</span> <span class="o">=</span> <span class="n">has_meta</span> <span class="ow">and</span> <span class="s">&quot;schema_type&quot;</span> <span class="ow">in</span> <span class="n">x</span><span class="p">[</span><span class="s">&quot;__meta&quot;</span><span class="p">]</span>

        <span class="n">have_table</span> <span class="o">=</span> <span class="n">has_schema_type</span> <span class="ow">and</span> <span class="n">x</span><span class="p">[</span><span class="s">&quot;__meta&quot;</span><span class="p">][</span><span class="s">&quot;schema_type&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s">&quot;TwoDimTable&quot;</span>
        <span class="k">if</span> <span class="n">have_table</span><span class="p">:</span>
          <span class="n">col_formats</span> <span class="o">=</span> <span class="p">[</span><span class="n">c</span><span class="p">[</span><span class="s">&quot;format&quot;</span><span class="p">]</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">x</span><span class="p">[</span><span class="s">&quot;columns&quot;</span><span class="p">]]</span>
          <span class="n">table_header</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="s">&quot;name&quot;</span><span class="p">]</span>
          <span class="n">table_descr</span>  <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="s">&quot;description&quot;</span><span class="p">]</span>
          <span class="n">col_types</span> <span class="o">=</span> <span class="p">[</span><span class="n">c</span><span class="p">[</span><span class="s">&quot;type&quot;</span><span class="p">]</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">x</span><span class="p">[</span><span class="s">&quot;columns&quot;</span><span class="p">]]</span>
          <span class="n">col_headers</span> <span class="o">=</span> <span class="p">[</span><span class="n">c</span><span class="p">[</span><span class="s">&quot;name&quot;</span><span class="p">]</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">x</span><span class="p">[</span><span class="s">&quot;columns&quot;</span><span class="p">]]</span>
          <span class="n">row_headers</span> <span class="o">=</span> <span class="p">[</span><span class="s">&quot;&quot;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">col_headers</span><span class="p">))]</span>
          <span class="n">cell_values</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="s">&quot;data&quot;</span><span class="p">]</span>
          <span class="n">tbl</span> <span class="o">=</span> <span class="n">H2OTwoDimTable</span><span class="p">(</span><span class="n">row_header</span><span class="o">=</span><span class="n">row_headers</span><span class="p">,</span> <span class="n">col_header</span><span class="o">=</span><span class="n">col_headers</span><span class="p">,</span>
                               <span class="n">col_types</span><span class="o">=</span><span class="n">col_types</span><span class="p">,</span> <span class="n">table_header</span><span class="o">=</span><span class="n">table_header</span><span class="p">,</span>
                               <span class="n">raw_cell_values</span><span class="o">=</span><span class="n">cell_values</span><span class="p">,</span>
                               <span class="n">col_formats</span><span class="o">=</span><span class="n">col_formats</span><span class="p">,</span><span class="n">table_description</span><span class="o">=</span><span class="n">table_descr</span><span class="p">)</span>
          <span class="n">x</span> <span class="o">=</span> <span class="n">tbl</span>
        <span class="k">else</span><span class="p">:</span>
          <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">x</span><span class="p">:</span>
            <span class="n">x</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">H2OConnection</span><span class="o">.</span><span class="n">_process_tables</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
      <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">it</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)):</span>
          <span class="n">x</span><span class="p">[</span><span class="n">it</span><span class="p">]</span> <span class="o">=</span> <span class="n">H2OConnection</span><span class="o">.</span><span class="n">_process_tables</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">it</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">x</span>

  <span class="k">global</span> <span class="n">_rest_ctr</span>
  <span class="n">_rest_ctr</span> <span class="o">=</span> <span class="mi">0</span>
  <span class="nd">@staticmethod</span>
<div class="viewcode-block" id="H2OConnection.rest_ctr"><a class="viewcode-back" href="../../other.html#h2o.connection.H2OConnection.rest_ctr">[docs]</a>  <span class="k">def</span> <span class="nf">rest_ctr</span><span class="p">():</span> <span class="k">global</span> <span class="n">_rest_ctr</span><span class="p">;</span> <span class="k">return</span> <span class="n">_rest_ctr</span></div></div>

<span class="c"># On exit, close the session to allow H2O to cleanup any temps</span>
<div class="viewcode-block" id="end_session"><a class="viewcode-back" href="../../other.html#h2o.connection.end_session">[docs]</a><span class="k">def</span> <span class="nf">end_session</span><span class="p">():</span>
  <span class="k">try</span><span class="p">:</span>
    <span class="n">H2OConnection</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="n">url_suffix</span><span class="o">=</span><span class="s">&quot;InitID&quot;</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="s">&quot;Sucessfully closed the H2O Session.&quot;</span><span class="p">)</span>
  <span class="k">except</span><span class="p">:</span>
    <span class="k">pass</span></div>

<div class="viewcode-block" id="get_human_readable_size"><a class="viewcode-back" href="../../other.html#h2o.connection.get_human_readable_size">[docs]</a><span class="k">def</span> <span class="nf">get_human_readable_size</span><span class="p">(</span><span class="n">num</span><span class="p">):</span>
  <span class="n">exp_str</span> <span class="o">=</span> <span class="p">[(</span><span class="mi">0</span><span class="p">,</span> <span class="s">&#39;B&#39;</span><span class="p">),</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="s">&#39;KB&#39;</span><span class="p">),</span> <span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="s">&#39;MB&#39;</span><span class="p">),</span> <span class="p">(</span><span class="mi">30</span><span class="p">,</span> <span class="s">&#39;GB&#39;</span><span class="p">),</span> <span class="p">(</span><span class="mi">40</span><span class="p">,</span> <span class="s">&#39;TB&#39;</span><span class="p">),</span> <span class="p">(</span><span class="mi">50</span><span class="p">,</span> <span class="s">&#39;PB&#39;</span><span class="p">),</span> <span class="p">]</span>
  <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
  <span class="n">rounded_val</span> <span class="o">=</span> <span class="mi">0</span>
  <span class="k">while</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">exp_str</span><span class="p">)</span> <span class="ow">and</span> <span class="n">num</span> <span class="o">&gt;=</span> <span class="p">(</span><span class="mi">2</span> <span class="o">**</span> <span class="n">exp_str</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]):</span>
    <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="n">rounded_val</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">num</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">**</span> <span class="n">exp_str</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="mi">2</span><span class="p">)</span>
  <span class="k">return</span> <span class="s">&#39;</span><span class="si">%s</span><span class="s"> </span><span class="si">%s</span><span class="s">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">rounded_val</span><span class="p">,</span> <span class="n">exp_str</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span></div>


<div class="viewcode-block" id="get_human_readable_time"><a class="viewcode-back" href="../../other.html#h2o.connection.get_human_readable_time">[docs]</a><span class="k">def</span> <span class="nf">get_human_readable_time</span><span class="p">(</span><span class="n">epochTimeMillis</span><span class="p">):</span>
  <span class="n">days</span> <span class="o">=</span> <span class="n">epochTimeMillis</span><span class="o">/</span><span class="p">(</span><span class="mi">24</span><span class="o">*</span><span class="mi">60</span><span class="o">*</span><span class="mi">60</span><span class="o">*</span><span class="mf">1000.0</span><span class="p">)</span>
  <span class="n">hours</span> <span class="o">=</span> <span class="p">(</span><span class="n">days</span><span class="o">-</span><span class="n">math</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span><span class="n">days</span><span class="p">))</span><span class="o">*</span><span class="mi">24</span>
  <span class="n">minutes</span> <span class="o">=</span> <span class="p">(</span><span class="n">hours</span><span class="o">-</span><span class="n">math</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span><span class="n">hours</span><span class="p">))</span><span class="o">*</span><span class="mi">60</span>
  <span class="n">seconds</span> <span class="o">=</span> <span class="p">(</span><span class="n">minutes</span><span class="o">-</span><span class="n">math</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span><span class="n">minutes</span><span class="p">))</span><span class="o">*</span><span class="mi">60</span>
  <span class="n">milliseconds</span> <span class="o">=</span> <span class="p">(</span><span class="n">seconds</span><span class="o">-</span><span class="n">math</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span><span class="n">seconds</span><span class="p">))</span><span class="o">*</span><span class="mi">1000</span>
  <span class="n">duration_vec</span> <span class="o">=</span> <span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span><span class="n">t</span><span class="p">))</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="p">[</span><span class="n">days</span><span class="p">,</span><span class="n">hours</span><span class="p">,</span><span class="n">minutes</span><span class="p">,</span><span class="n">seconds</span><span class="p">,</span><span class="n">milliseconds</span><span class="p">]]</span>
  <span class="n">names_duration_vec</span> <span class="o">=</span> <span class="p">[</span><span class="s">&quot;days&quot;</span><span class="p">,</span><span class="s">&quot;hours&quot;</span><span class="p">,</span><span class="s">&quot;minutes&quot;</span><span class="p">,</span><span class="s">&quot;seconds&quot;</span><span class="p">,</span><span class="s">&quot;milliseconds&quot;</span><span class="p">]</span>

  <span class="n">duration_dict</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">names_duration_vec</span><span class="p">,</span> <span class="n">duration_vec</span><span class="p">))</span>

  <span class="n">readable_time</span> <span class="o">=</span> <span class="s">&quot;&quot;</span>
  <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">names_duration_vec</span><span class="p">:</span>
    <span class="k">if</span> <span class="n">duration_dict</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
      <span class="n">readable_time</span> <span class="o">+=</span> <span class="nb">str</span><span class="p">(</span><span class="n">duration_dict</span><span class="p">[</span><span class="n">name</span><span class="p">])</span> <span class="o">+</span> <span class="s">&quot; &quot;</span> <span class="o">+</span> <span class="n">name</span> <span class="o">+</span> <span class="s">&quot; &quot;</span>

  <span class="k">return</span> <span class="n">readable_time</span></div>

<div class="viewcode-block" id="is_int"><a class="viewcode-back" href="../../other.html#h2o.connection.is_int">[docs]</a><span class="k">def</span> <span class="nf">is_int</span><span class="p">(</span><span class="n">possible_int</span><span class="p">):</span>
  <span class="k">try</span><span class="p">:</span>
    <span class="nb">int</span><span class="p">(</span><span class="n">possible_int</span><span class="p">)</span>
    <span class="k">return</span> <span class="bp">True</span>
  <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
    <span class="k">return</span> <span class="bp">False</span></div>

<div class="viewcode-block" id="as_int"><a class="viewcode-back" href="../../other.html#h2o.connection.as_int">[docs]</a><span class="k">def</span> <span class="nf">as_int</span><span class="p">(</span><span class="n">the_int</span><span class="p">):</span>
  <span class="k">if</span> <span class="ow">not</span> <span class="n">is_int</span><span class="p">(</span><span class="n">the_int</span><span class="p">):</span>
    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&quot;Not a valid int value: &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">the_int</span><span class="p">))</span>
  <span class="k">return</span> <span class="nb">int</span><span class="p">(</span><span class="n">the_int</span><span class="p">)</span></div>

<span class="k">def</span> <span class="nf">_kill_jvm_fork</span><span class="p">():</span>
  <span class="k">global</span> <span class="n">__H2OCONN__</span>
  <span class="k">if</span> <span class="n">__H2OCONN__</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
    <span class="k">if</span> <span class="n">__H2OCONN__</span><span class="o">.</span><span class="n">_child</span><span class="p">:</span>
      <span class="n">__H2OCONN__</span><span class="o">.</span><span class="n">_child</span><span class="o">.</span><span class="n">kill</span><span class="p">()</span>
      <span class="k">print</span><span class="p">(</span><span class="s">&quot;Successfully stopped H2O JVM started by the h2o python module.&quot;</span><span class="p">)</span>

<span class="n">atexit</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="n">_kill_jvm_fork</span><span class="p">)</span>
<span class="n">atexit</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="n">end_session</span><span class="p">)</span>
</pre></div>

          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2015, H2O.
    </p>
  </div>

  <a href="https://github.com/snide/sphinx_rtd_theme">Sphinx theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>
</footer>
        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../../',
            VERSION:'',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="../../_static/jquery.js"></script>
      <script type="text/javascript" src="../../_static/underscore.js"></script>
      <script type="text/javascript" src="../../_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="../../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>