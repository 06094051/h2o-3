h2o.kmeans <- function(data, cols = '', # AUTOGENERATED PARAMETERS:
                       centers, key, iter.max, normalize, init, seed #, dropNACols
) {# Set Input Parameters for Kmeans
  parms = list()

  # Verify Training Frame
  if(data %i% "ASTNode") delete = TRUE && invisible(nrow(data)) else delete = FALSE
  args <- .verify_datacols(data, cols)
  parms = .addStringParm(parms, k = "training_frame", v = data@key)

  # AUTOGENERATED DEFAULT VALUES FOR PARAMETERS
  res = .h2o.__remoteSend(h, .h2o.__KMEANS_PARAMS)
  res = res$model_builders$kmeans$parameters
  var_name = sapply(res, function(param) param$name)
  var_value = sapply(res, function(param) param$actual_value)
  default_params = mapply(assign, var_name, var_value)

  # Fill in missing parameters
  if(missing(centers)) centers = default_params$"K"
  if(missing(iter.max)) iter.max = as.integer(default_params$"max_iters")
  if(missing(normalize)) normalize = as.logical(default_params$"normalize")
  if(missing(init)) init = default_params$"init"
  if(missing(seed)) seed = as.numeric(default_params$"seed")

  # Run check on R's side
  if(!missing(key)) {
    if(!is.character(key)) stop("key must be of class character")
    if(nchar(key) > 0 && regexpr("^[a-zA-Z_][a-zA-Z0-9_.]*$", key)[1] == -1)
      stop("key must match the regular expression '^[a-zA-Z_][a-zA-Z0-9_.]*$'")
    parms = .addStringParm(parms, k = "destination_key", v = key)
  }
  if(!is.numeric(centers) && !is.integer(centers)) stop('centers must be a positive integer')
  if( any(centers < 1) ) stop("centers must be an integer greater than 0")
  if(!is.numeric(iter.max)) stop('iter.max must be numeric')
  if( any(iter.max < 1)) stop('iter.max must be >= 1')
  if(!is.logical(normalize)) stop("normalize must be logical")
  myInit = switch(init, none = "None", plusplus = "PlusPlus", furthest = "Furthest")
  if(length(init) > 1 || !init %in% c("None", "PlusPlus", "Furthest", "none", "plusplus", "furthest"))
    stop("init must be one of 'None', 'PlusPlus', 'Furthest', 'none', 'plusplus', 'furthest'")
  if(!is.numeric(seed)) stop("seed must be numeric")
#  if(!is.logical(dropNACols)) stop("dropNACols must be logical")

  parms = .addIntParm(parms, k = "K", v = centers )
#  parms = .addStringParm(parms, k = "destination_key", v = if(!missing(key)) key else default_params$"destination_key" )
  parms = .addIntParm(parms, k = "max_iters", v = iter.max)
  parms = .addBooleanParm(parms, k = "normalize", v = normalize)
  parms = .addStringParm(parms, k = "init", v = init)
  parms = .addDoubleParm(parms, k = "seed", v = seed)

  model_params <- .h2o.__remoteSend(data@h2o, method = "POST", .h2o.__KMEANS_PARAMS, .params = parms)
  res <- .h2o.__remoteSend(data@h2o, method = "POST", .h2o.__Models %p0% model_params$jobs[[1]]$dest$name)
  return(res)

  }