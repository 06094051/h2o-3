#'
#' KMeans Model in H2O
#'
#' Performs k-means clustering on an H2O dataset.
#'
#' @param data An \linkS4class{H2OParsedData} object containing the variables in the model.
#' @param ignored_columns (Optional) A vector containing the data columns on which k-means ignores.
#' @param centers \code{Defaults to 2} The number of clusters k. Must be between 2 and 1e7.
#' @param key (Optional) The unique hex key assigned to the resulting modle. Automatically generated if none is
#         provided.
#' @param iter.max \code{Defaults to 1000} The maximum number of iterations allowed. Must be between 1 and 1e6.
#' @param normalize \code{Defaults to TRUE} Logical, indicates whether the data should be normalized before
#'        running k-means.
#' @param init \code{Defaults to "Furthest"} Enum, which selects the k initial cluster centroids. Possible values are
#'        "None": for random initialization, "PlusPlus": for k-means plust initialization, and "Furthest": for
#'        intialization at the furthest point from each succcessive centroid.
#' @param seed (Optional) Random seed used to initialize the cluster centroids.
#' @return An object of class \linkS4class{H2OKMeansModel}.
#' @examples
#' library(h2o)
#' localH2O = h2o.init()
#' prosPath = system.file("extdata", "prostate.csv", package = "h2o")
#' prostate.hex = h2o.importFile(localH2O, path = prosPath)
#' prostate.km <- h2o.kmeans(data = prostate.hex, centers = 10, ignored_columns = "ID")
h2o.kmeans <- function(data, ignored_columns, # AUTOGENERATED PARAMETERS:
                       centers,
                       key,
                       iter.max,
                       normalize,
                       init,
                       seed #,dropNACol
) {# Set Input Parameters for Kmeans
  parms <- list()

  if(delete <- (data %i% "ASTNode")) invisible(nrow(data))

  if(!missing(data)) parms[["training_frame"]] <- data@key
  if(!missing(ignored_columns)) parms[["ignored_columns"]] <- .collapse(.verify_datacols(data, ignored_columns)$cols)
  if(!missing(centers)) parms[["K"]] <- centers
  if(!missing(key)) parms[["destination_key"]] <- key
  if(!missing(iter.max)) parms[["max_iters"]] <- iter.max
  if(!missing(normalize)) parms[["normalize"]] <- normalize
  if(!missing(init)) parms[["init"]] <- init
  if(!missing(seed)) parms[["seed"]] <- seed

  model <- .run(data@h2o, 'kmeans', parms)

  if(delete) h2o.rm("data")

  model
  }