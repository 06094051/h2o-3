#'
#' KMeans Model in H2O
#'
#' Performs k-means clustering on an H2O dataset.
#'
#'
#' @param training_frame An \linkS4class{H2OParsedData} object containing the variables in the model.
#' @param ignored_columns (Optional) A vector containing the data columns on which k-means ignores.
#' @param K \code{Defaults to 2} The number of clusters k. Must be between 2 and 1e7.
#' @param destination_key (Optional) The unique hex key assigned to the resulting modle. Automatically generated if none
#'        is provided.
#' @param max_iters The maximum number of iterations allowed. Must be between 1 and 1e6.
#' @param normalize Logical, indicates whether the data should be normalized before
#'        running k-means.
#' @param init Enum, which selects the k initial cluster centroids. Possible values are "None": for random
#'        initialization, "PlusPlus": for k-means plus initialization, and "Furthest": for intialization at the
#'        furthest point from each succcessive centroid.
#' @param seed (Optional) Random seed used to initialize the cluster centroids.
#' @return Returns an object of class \linkS4class{H2OKMeansModel}.
#' @examples
#' library(h2o)
#' localH2O = h2o.init()
#' prosPath = system.file("extdata", "prostate.csv", package = "h2o")
#' prostate.hex = h2o.importFile(localH2O, path = prosPath)
#' prostate.km <- h2o.kmeans(data = prostate.hex, K = 10, ignored_columns = "ID")
h2o.kmeans <- function(training_frame, ignored_columns, K,
                       ## AUTOGENERATED PARAMETERS ##     #these defaults are not read by h2o
                       destination_key,                   #h2o generates its own default parameters
                       max_iters = 1000,
                       normalize = TRUE,
                       init = c("Furthest","None", "PlusPlus"),
                       seed)
{
  parms <- list()

  # Required args: training_frame
  if( missing(training_frame) ) stop ("argument \"training_frame\" is missing, with no default")

  if(delete <- (training_frame %i% "ASTNode")) invisible(nrow(training_frame))      # handle ASTNodes

  # Gather user input
  parms <- lapply(as.list(match.call()[-1L]), eval)


  # Extract valid H2O arguments
  parms[["training_frame"]] <- training_frame
  if( !(missing(ignored_columns)) )parms[["ignored_columns"]] <- .verify_datacols(training_frame, ignored_columns)$cols

  # Error check and build model
  model <- .run(training_frame@h2o, 'kmeans', parms)

  if(delete) h2o.rm("training_frame")                                     # handle ASTNodes

  model
}